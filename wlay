#!/bin/bash
# WezTermオーバーレイペイン: split-pane + zoom-paneで元ペインを覆う
# プログラム終了時にペインが自動閉鎖→unzoom→元ペイン復元

set -euo pipefail

if [ -z "${WEZTERM_PANE:-}" ]; then
  echo "Error: WezTerm環境外です" >&2
  exit 1
fi

case "${1:-sh}" in
  sh)  set -- zsh ;;
  nv)  shift; set -- nvim "$@" ;;
  git) shift; set -- lazygit "$@" ;;
esac

pane_id=$(wezterm cli split-pane --bottom --cwd "$(pwd)" -- "$@")
wezterm cli zoom-pane --zoom --pane-id "$pane_id"
